<!-- <%= render "shared/errors", obj: @user %> -->
<% flash.each do |key, value| %>
  <div class="container" style="margin-top: 0.2%;">
    <div class="alert alert-<%= key == "alert" ? "danger" : "success" %> alert-dismissible fade show" role="alert">
      <h4 class="alert-heading">
        <%= key == "alert" ? "An error occurred." : "Success" %>
      </h4>
      <ul>
        <li><%= value %></li>
      </ul>
      <button type="button" class="close" data-dismiss="alert">
        <span>&times;</span>
      </button>
    </div>
  </div> 
<% end %>

<div class="container shadow p-3 mb-5 bg-white col-5  rounded" style="margin-top: 3%;">
    <div class="card">
        <div class="card-header text-center">
            Log in to MyBlog
        </div>
        <div class="radio-btn" style="display: flex; flex-wrap: wrap; justify-content: space-around; margin: 0% 20%;">
            Log in using:
            <div class="username">
                <input type="radio" name="type" value="username" onchange="handleChoice()" id="username" checked>
                <label for="username">Username</label>
            </div>
            <div class="email">
                <input type="radio" name="type" value="email" onchange="handleChoice()" id="email">
                <label for="email">Email</label>
            </div>
        </div>
        <div class="card-body" style="text-align: justify;">
            <!-- -->
            <%= form_with(scope: :session, url: login_path ) do |form| %>
                <div class="form-group row" id="username-field" style="display: block; display: flex; flex-wrap: wrap; justify-content: space-around; width: 80%; margin-left: 9%;">
                    <%= form.label :Username, class: "col-5 col-form-label" %>
                    <%= form.text_field :username, value:"", id: "usernameField", class: "col-6 form-control", placeholder: "Username" %>
                </div>

                <div class="form-group row" id="email-field" style="display: none; flex-wrap: wrap; justify-content: space-around; width: 80%; margin-left: 9%;">
                    <%= form.label :Email, class: "col-5 col-form-label" %>
                    <%= form.text_field :email, value:"", id: "emailField", class: "col-6 form-control", placeholder: "Email" %>
                </div>

                
                <% if @user.new_record? %>
                    <div class="form-group row" style="display: flex; flex-wrap: wrap; justify-content: space-around; width: 80%; margin-left: 9%;">
                        <%= form.label :Password, class: "col-5 col-form-label" %>
                        <%= form.text_field :password, class: "col-6 form-control", placeholder: "Password"  %>
                    </div>
                <%end%>
                <div style="text-align: center; margin: 0.3%;">
                    <%= form.submit "Log in", class: "card_btn", id: "signup_btn"  %>
                </div>
                <div style="text-align: center; margin-top: 2%;">
                    <%= link_to "[ Go back ]", root_path, method: :get, class:"go-back-home" %>
                </div>
            <% end %>

        </div>
    </div>
</div>
<script>
function handleChoice() {
    const selected = document.querySelector('input[name="type"]:checked').value;

    document.getElementById("username-field").style.display = "none";
    document.getElementById("email-field").style.display = "none";

    // console.log(document.getElementById("username-field").style.display);
    document.getElementById("usernameField").value = ""
    document.getElementById("emailField").value = ""

    if (selected === "username") {
        document.getElementById("username-field").style.display = "block flex";
        
    } else {
        document.getElementById("email-field").style.display = "block flex";    
    }
}
</script>